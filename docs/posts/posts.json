[
  {
    "path": "posts/welcome/",
    "title": "Welcome bigots",
    "description": "We're gonna be doin all kinds of shit folks; anything but developing meaningful and rewarding relationships with my friends cause.. thats, not very 2020 is it now? NOOO!! So we're exploring Multivariate Analysis. I hope you either learn something against your will or are implicated in a charity scheme associated with this blog which of course I'd never do, I have fascist friends.",
    "author": [
      {
        "name": "Gavin Gordon",
        "url": "https://example.com/norajones"
      }
    ],
    "date": "2020-12-16",
    "categories": [],
    "contents": "\r\nHere is the vision and lifelong quote by ME, the author:\r\n“I’m gonna trade this life for fortune and fame\r\nI’d even cut my hair and change my name”\r\nand also by THIs guy:\r\n“Every good gold digger’s gonna wind up there\r\nEvery Playboy Bunny with her bleached blond hair”\r\nThis reminds you of nothing.\r\n\r\n\r\n\r\n",
    "preview": {},
    "last_modified": "2020-12-16T13:28:21-04:00",
    "input_file": {}
  },
  {
    "path": "posts/2020-12-16-water-quality/",
    "title": "Waste Water Treatment",
    "description": "Waste water samples are divided into paired units and sent to separate laboratories for testing of the Biochemical Oxygen Demand and the amount of Suspended Solids. This is done to make sure that the measurements which guide the activities of the treatment plant are accurate and consistent. The Hotelling T2 test is used to make the comparison across the two dependent variables with the State/Commercial laboratory serving as the grouping variable.",
    "author": [
      {
        "name": "Gavin Gordon",
        "url": "https://example.com/norajones"
      }
    ],
    "date": "2020-12-16",
    "categories": [
      "Hotelling T2",
      "Independent Groups"
    ],
    "contents": "\r\n\r\n\r\n\r\n\r\n\r\n\r\nProblem\r\nMunicipal waste water treatment plants are required by law to monitor their discharges into rivers and streams on a regular basis. Concern about the reliability of data from one of these self-monitoring programs led to a study in which samples of effluent were divided and sent to two laboratories for testing. One-half of each sample was sent to the Wisconsin State Laboratory of Hygiene, and one-half was sent to a private commercial laboratory routinely used in the monitoring program. Measurements of biochemical oxygen demand (BOD) and suspended solids (SS) were obtained, for n = 11 sample splits, from the two laboratories.\r\nThis problem will be approached using the paired Hotelling T2 test.\r\nNote: This problem was taken from Johnson 1992, example 6.1. I have added the exploration of assumptions in the replication of the results.\r\n       \r\n\r\npreservefa8279285b0b2bcd\r\n\r\n       \r\nCheck for Assumptions\r\nOutliers and Group level Normality\r\n\r\n\r\n\r\nFigure 1: Normal Distribution plots for BOD\r\n\r\n\r\n\r\nThe histogram for the BOD differences is skewed with most of the data falling in the negative number range (median equals -14 as well). The points seem to oscillate about the QQ, PP and cumulative distribution plots but seem to hug the lines; this is not ideal but can occur especially with small sample sizes. The plot behaviors show promising approximations to normality. There does not seem to be any alarming data points for consideration as outliers.\r\n       \r\n\r\n\r\n\r\nFigure 2: Normal Distribution plots for SS\r\n\r\n\r\n\r\nThe SS variable does not follow a normal distribution. There are two data points which have differences that are quite alarming relative to the other data points. This is most clearly shown in the histogram where these two values occur above the value of 40. It is likely that these two points will distort the normality assumption; also they present the idea that there may be a subgroup within the dataset that needs to be taken into account. None of the distribution curves seem to match well with the data.\r\n       \r\n\r\n\r\npreservee79d9e6ca6bb48b8\r\n\r\n\r\nThe bivariate normal distribution seems to be bimodal which adds more evidence to the idea that there may be a subgroup present within the data. Overall the normality assumption is not to a satisfactory level when all of the data is included.\r\n       \r\nOutlier Removal\r\n\r\n\r\n\r\nFigure 3: Normal Distribution plots for SS with outliers removed\r\n\r\n\r\n\r\nWhen the two outliers are removed, the BOD variable shows even more acceptable behavior with respect to normality.\r\n       \r\n\r\n\r\n\r\nFigure 4: Distribution Plots for Commerical Lab BOD Variable\r\n\r\n\r\n\r\nWith the removal of the two outliers another problem surfaces with the SS variable. It would seem that there is another grouping of the data points such that four are positive while five are negative. It is unlikely that any meaningful information can be derived with respect to this variable; an investigation targeting this variable should be undertaken. The bivariate contour plot seems to have lost it’s interpretability for this data.\r\n       \r\nSub-populations within the vector means: Details on the methodology of the experiment were not given to affirm the randomization of the experimental units when being sent to the commercial/state laboratory although this can be assumed given the nature/sensitivity of the problem. There are no other variables available to conduct subgroup analysis to confirm/reject the idea that there are other factors that contribute to the outcome of the experiment. There does seem to be evidence that indicates a sub-population is present thus this assumption is considered to be violated.\r\nIndependence of the paired experimental units: the problem description suggests that samples were taken and then each was split to produce the pair. We will assume that the samples were taken independently of each other with the dependence being formed by the split.\r\nIf this technique were to used under these conditions the results should be taken with caution; there should be an investigation into the bimodal nature of the distribution. The analysis will proceed for illustrative purposes.\r\n       \r\nData Analysis\r\n\r\n\r\n\r\nTable 1: Hotelling Output\r\n\r\n\r\nT2 Stat\r\n\r\n\r\nF value\r\n\r\n\r\nP value\r\n\r\n\r\n13.64\r\n\r\n\r\n6.14\r\n\r\n\r\n0.02\r\n\r\n\r\nTable 1: Confidence Intervals\r\n\r\n\r\nVariable\r\n\r\n\r\nLower\r\n\r\n\r\nUpper\r\n\r\n\r\nBOD\r\n\r\n\r\n-22.45\r\n\r\n\r\n3.73\r\n\r\n\r\nSS\r\n\r\n\r\n-5.70\r\n\r\n\r\n32.25\r\n\r\n\r\n\r\nSo as you might have noticed we have a rather peculiar situation. The test statistic p value would suggest that the means of BOD and SS are significantly different from zero. However the confidence intervals include zero which usually indicate that, since zero is a possibility then you may not assume a difference. The explanation given states that the confidence intervals are constructed around a value which is represented as a linear combination of the differences in BOD and SS; for all of the possible linear combinations only two result in intervals that contain zero being the (1,0) and (0,1) pairs. All other linear combinations do not contain zero.\r\nThe interpretation that will be adopted is that there seems to be a difference in the results from the two labs given that most of the data from the BOD variable is highly skewed in one direction that is below the zero margin.\r\n \r\n \r\n \r\nReferences\r\nJohnson, R. A., & Wichern, D. W. (1992). Applied multivariate statistical analysis. Englewood Cliffs, N.J: Prentice Hall\r\n\r\n\r\n\r\n",
    "preview": "posts/2020-12-16-water-quality/water-quality_files/figure-html5/unnamed-chunk-4-1.png",
    "last_modified": "2020-12-16T16:16:44-04:00",
    "input_file": "water-quality.utf8.md"
  },
  {
    "path": "posts/2020-12-16-lizards-cnemidophorus-vs-sceloporus/",
    "title": "Lizards: Cnemidophorus vs Sceloporus",
    "description": "This was supposed to be a moment where the necessity of performing Multivariate analysis was showcased over the Univariate analysis. Mass and Snout-Vent measurements were taken from the above mentioned lizard generas, and these were compared. Looking at the univariate tests for group differences we would not be able to see any difference while strictly applying the Hotelling T2 test we would have found a difference. However while the checking the assumptions of the Hotelling test, questions were raised.",
    "author": [
      {
        "name": "Gavin Gordon",
        "url": "https://example.com/norajones"
      }
    ],
    "date": "2020-12-16",
    "categories": [
      "Hotelling T2",
      "Independent Samples"
    ],
    "contents": "\r\n\r\n\r\n\r\n\r\n\r\n\r\nProblem\r\nA zoologist collected lizards in the southwestern United States. Among other variables, he measured mass (in grams) and the snout-vent length (in millimeters). Because the tails sometimes break off in the wild, the snout-vent length is a more representative measure of length. The data for the lizards from two genera, Cnemidophorus (C) and Sceloporus (S) was collected in 1997 and 1999.\r\nThis activity is aimed to replicate the findings for example 6.71 to show that there is difference in the mass and snout-vent means for the genera of the two lizards using the Hotelling T2 multivariate test for independent samples. I included the testing of the analysis assumptions as well as a bit of exploratory analysis. When the univariate cases are explored for differences the result is that there is none thus the example was used to highlight the need for inspection using multivariate tests.\r\n \r\n \r\n \r\n\r\npreserve099a32ada4362f96\r\n\r\n \r\n \r\n \r\nAssumptions\r\nNormality and Outliers\r\n\r\n\r\n\r\nFigure 1: Normal Distribution plots of SVL for Type C\r\n\r\n\r\n\r\nIt should be noted that the lines in the above plots indicate the normal distribution features that would be assumed if the data were treated as though it had come from such a distribution. The points and histogram are what we use to check if the assumed distribution is a good fit. The mass for the type C lizard is not normally distributed. The histogram is highly skewed with what seems to have two peaks. The points around each of the distribution curves do not hug the line in any satisfactory or consistent manner.\r\n \r\n \r\n \r\n\r\n\r\n\r\nFigure 2: Normal Distribution plots of SVL for Type C\r\n\r\n\r\n\r\nThe normality of the SVL variable for the type C lizards are also not satisfactory as these display similar features to the mass variable.\r\n \r\n \r\n \r\n\r\n\r\n\r\npreserve05291b4b7db6901b\r\n\r\n\r\n\r\n\r\npreserve6b7acc810e34ca01\r\n\r\n\r\n\r\nThe above show the marginal density plots without any form of distribution imposed onto the data. We can see that in each variable which seems to correlate highly with each other, has two modes. This will be problematic as we are using techniques that accomodate only one mode. It may be that this problem is resolved once the bivariate density is taken into account but unfortunately in this case it is not so.\r\n \r\n \r\n \r\n\r\n\r\npreserved8c169b5cc93501a\r\n\r\n\r\nIt is evident that we are not be working with a unimodal distribution. This will be an issue since only one mean vector is used as the measure of central tendency within the groups. This would explain the distortion that is found within the normality plots for the type C lizard. This indicates that there may be another variable that needs to be taken into consideration for the analysis or another method that accomodates multiple modes must be used.\r\n \r\n \r\n\r\n\r\ntypecnorm <- data %>% filter(type == \"C\") %>% select(!type) %>% mvnTest(B = 2000)\r\ntypecnorm$mv.test[2]\r\n\r\n\r\np-value \r\n  0.117 \r\n\r\n \r\n  The above is a test for multivariate normal distributions. So I interpret these tests for normality with more caution now. We have the result which is considerately higher than the usual cut off value of 0.05 so one might have been somewhat comfortable with the normality assumption being met. However we can see that this does not mean that it’s the type of normal distribution that is suitable for the technique as distributions which have more than one peak can certainly still count as being normally distributed.  \r\n \r\n \r\n\r\n\r\n\r\nFigure 3: Normal Distribution plots of Mass for Type S\r\n\r\n\r\n\r\nFor a sample size this large the central limit theorem would be applied for the normality assumption. However I still find it useful to make the plots when checking for subgroup indicators. In this case the normality assumption is well satisfied.\r\n \r\n \r\n \r\n\r\n\r\n\r\nFigure 4: Normal Distribution plots of Snout Length for Type S\r\n\r\n\r\n\r\nFor the most part the normality assumption is satisfied but there does seem to be an indicator of a small subgroup; the histogram seems to have a small peak occuring in the right tail. This is better seen with the density plot.\r\n \r\n \r\n \r\n\r\n\r\n\r\npreserveed736218990e2ff8\r\n\r\n\r\n\r\n\r\npreserveea5b698746885f87\r\n\r\n\r\n\r\nThe above plots are again with no imposed distribution on the data. We can see that there is a global peak so these two variables for the type S lizards are appropriate for a unimodal analysis. There is the instance of the minor peak in the tail; this can be explored but may not change the analysis by much.\r\n \r\n \r\n \r\n\r\n\r\npreserve71eb50448277437a\r\n\r\n\r\nThe bivariate density plot for type S lizards seems to be to a satisfactory level. The range for the peak is somewhat flat as seen in the marginal density curve for the mass variable but a mean vector should still be able to capture the information quite well. Though this makes me wonder about the interpretation of the values of confidence intervals in the frequentist vs the bayesian paradigms. Since only one value within the frequentist world is correct compared to being given probabilities for a range in the bayesian world; one might think the bayesian interpretation to be more suited here as there are quite a few values that may compete for the mean of the distribution for type S lizards.\r\n \r\n \r\n \r\n\r\n\r\ntypesnorm <- data %>% filter(type == \"S\") %>% select(!type) %>% mvnTest(B = 2000)\r\ntypesnorm$mv.test[2]\r\n\r\n\r\np-value \r\n 0.1435 \r\n\r\nWe saw that the univariate and bivariate plots show appealing behaviors and while the type S lizards do satisfy the test for multivariate normality it seems that there may be quite a bit of deformation happening such that the p value isn’t higher. This raises my curiosity with respect to what degree can we inspect a surface.\r\n\r\npreserve2f15769aabff37a9\r\n\r\nAlthough the data for snout-vent length approaches normality better there still remains the issue of the bimodal nature of the C group distribution.\r\n \r\n \r\n \r\n\r\npreserveea4ae62e9a300a65\r\n\r\nThe bivariate plot shows a strong linear correlation between mass and snout-vent length within the two types of lizards that appear to be different from each other. You may not be able to infer this judging from the mean and standard deviation from the descriptive summary tables (as in the case in the book). Most of the points are within the confidence region ellipses except for a few points that show minor deviation from the overall trend.  \r\n \r\n\r\n\r\n\r\n\r\nmass\r\n\r\n\r\nsvl\r\n\r\n\r\nmass\r\n\r\n\r\n0.35\r\n\r\n\r\n0.09\r\n\r\n\r\nsvl\r\n\r\n\r\n0.09\r\n\r\n\r\n0.03\r\n\r\n\r\n\r\n\r\nmass\r\n\r\n\r\nsvl\r\n\r\n\r\nmass\r\n\r\n\r\n0.51\r\n\r\n\r\n0.15\r\n\r\n\r\nsvl\r\n\r\n\r\n0.15\r\n\r\n\r\n0.04\r\n\r\nTable 1: Test for Equality of Variance\r\nTestName\r\nStatistic\r\nDegreesFreedom\r\nPval\r\nBoxM\r\n3.02\r\n3\r\n0.39\r\n\r\nThe test for equality of the Covariance matrices show that the variances are the same across the two groups of lizards.  \r\n \r\nThe multivariate test for appropriate skewness and kurtosis shows that the values are within tolerable ranges.  \r\n \r\nFinally I consider outliers; although it is the case that three potential outliers are identified via the Malahanobis distance values, these values are not considered outliers to the trend that is found between the variables. There no values were removed for this analysis.  \r\n \r\nAnalysis\r\nFirst we calculate the mean vector containing Mass and Snout Length for each type.\r\n\r\n\r\n\r\nThey used large sample inference.\r\n\r\n\r\n#poolvar <- (nS -1)/(nS+nC -2)   * typeScov + (nC -1)/(nS+nC-2) * typeCcov \r\n#poolvar\r\n\r\n\r\n\r\nNow we create the simultainous confidence intervals\r\n\r\n\r\n\r\n\r\n\r\nTable 2: Confidence Intervals\r\n\r\n\r\nVariable\r\n\r\n\r\nLower\r\n\r\n\r\nUpper\r\n\r\n\r\nMass\r\n\r\n\r\n-0.55\r\n\r\n\r\n0.30\r\n\r\n\r\nSvl\r\n\r\n\r\n-0.03\r\n\r\n\r\n0.21\r\n\r\n\r\n\r\n#det of covariance matrix > 0 # did not include the correlation #need code for single mean comparison #need code for paired means comparison # sample size calculation\r\ncovmat <- cov(datafile[,3:5]) det(covmat)\r\ndo the regular t test interval for variable but use the bonferroni correction for p variables so alpha/p\r\n\r\n\r\n\r\n",
    "preview": "posts/2020-12-16-lizards-cnemidophorus-vs-sceloporus/lizards-cnemidophorus-vs-sceloporus_files/figure-html5/unnamed-chunk-4-1.png",
    "last_modified": "2020-12-16T16:47:28-04:00",
    "input_file": "lizards-cnemidophorus-vs-sceloporus.utf8.md"
  }
]
